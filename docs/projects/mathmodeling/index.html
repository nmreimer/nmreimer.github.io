<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nathaniel Reimer">
<meta name="dcterms.date" content="2023-12-15">
<meta name="description" content="A simple mathematical model of nitrogen runoff. This paper was created as part of final project for Math 432: Mathematical Modeling, taught by Will Mitchell.">

<title>Nathaniel Reimer - Advection Diffusion with Simple Erosion and Deposition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nathaniel Reimer</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#a-potential-model" id="toc-a-potential-model" class="nav-link" data-scroll-target="#a-potential-model">A Potential Model</a>
  <ul class="collapse">
  <li><a href="#implementation-with-scikit-finitediff" id="toc-implementation-with-scikit-finitediff" class="nav-link" data-scroll-target="#implementation-with-scikit-finitediff">Implementation with Scikit FiniteDiff</a></li>
  </ul></li>
  <li><a href="#model-behavior" id="toc-model-behavior" class="nav-link" data-scroll-target="#model-behavior">Model Behavior</a>
  <ul class="collapse">
  <li><a href="#modeling-with-different-advection" id="toc-modeling-with-different-advection" class="nav-link" data-scroll-target="#modeling-with-different-advection">Modeling with Different Advection</a></li>
  <li><a href="#anomalous-solute-transport" id="toc-anomalous-solute-transport" class="nav-link" data-scroll-target="#anomalous-solute-transport">Anomalous Solute Transport</a></li>
  </ul></li>
  <li><a href="#future-work" id="toc-future-work" class="nav-link" data-scroll-target="#future-work">Future Work</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advection Diffusion with Simple Erosion and Deposition</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Math</div>
    <div class="quarto-category">Macalester</div>
  </div>
  </div>

<div>
  <div class="description">
    A simple mathematical model of nitrogen runoff. This paper was created as part of final project for Math 432: Mathematical Modeling, taught by Will Mitchell.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nathaniel Reimer </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Pollutant runoff is harmful to many ecosystems. Agricultural runoff can be particularly harmful to ecosystems because it contains a high concentration of nitrogen. This nitrogen is primarily from nitrogen fertilizers vital to global food supplies. When nitrogen is allowed to enter oceans and waterways it can fuel phytoplankton blooms <span class="citation" data-cites="michaelbeman2005">(<a href="#ref-michaelbeman2005" role="doc-biblioref">Michael Beman, Arrigo, and Matson 2005</a>)</span>. Phytoplankton blooms, particularly those involving toxic species, can devastate ecosystems and the people that live near and rely on those ecosystems <span class="citation" data-cites="HAB2018">(<a href="#ref-HAB2018" role="doc-biblioref">Shumway, Burkholder, and Morton 2018</a>)</span>. There are a variety of mitigation methods for reducing the amount of nitrogen that is carried out of agricultural areas by runoff.</p>
</section>
<section id="a-potential-model" class="level2">
<h2 class="anchored" data-anchor-id="a-potential-model">A Potential Model</h2>
<p>We represent nitrogen dissolved in water with <span class="math inline">\(C\)</span> and nitrogen deposited on the ground with <span class="math inline">\(N\)</span>. Nitrogen in water is subject to simple advection-diffusion: <span class="math inline">\(C_{t} = -(Cv)_{x} + kC_{xx}\)</span>. Nitrogen on the ground is stationary. Some hydrological models of pollutant transport use similar logical frameworks. Shao et al.&nbsp;use an equivalent exchange layer to mediate between surface runoff and nutrients stored in the ground <span class="citation" data-cites="shao2023">(<a href="#ref-shao2023" role="doc-biblioref">Shao et al. 2023</a>)</span>. A fractional mobile-immobile model is similarly predicated on simple advection-diffusion with mobile and immobile components of the solute <span class="citation" data-cites="sun2020">(<a href="#ref-sun2020" role="doc-biblioref">Sun et al. 2020</a>)</span>. Both models present complicated methods for transfer between the two states.</p>
<p><span class="math display">\[
C_{t} = -(Cv)_{x} + kC_{xx} + N \frac{e^{v-n}}{1 + e^{v-n}} - C\frac{e^{n-v}}{1 + e^{n-v}}\\  
\]</span></p>
<p><span class="math display">\[
N_{t} = - N \frac{e^{v-n}}{1 + e^{v-n}} + C\frac{e^{n-v}}{1 + e^{n-v}}\\
\]</span></p>
<p>We represent transfers between ground nitrogen and dissolved nitrogen in this model with <span class="math inline">\(N \frac{e^{v-n}}{1 + e^{v-n}} - C\frac{e^{n-v}}{1 + e^{n-v}}\)</span>. For fixed levels of <span class="math inline">\(N\)</span> and <span class="math inline">\(C\)</span>, a velocity <span class="math inline">\(v &gt; n\)</span> will lead to erosion. For <span class="math inline">\(v &gt;&gt; n\)</span>, the rate of erosion approaches <span class="math inline">\(N\)</span>. On the other hand, if velocity <span class="math inline">\(v &lt; n\)</span> deposition will occur. For <span class="math inline">\(v &lt;&lt; n\)</span>, the rate of deposition approaches <span class="math inline">\(C\)</span>. This ensures that no deposition will occur if the dissolved concentration is zero and no erosion will occur if the concentration on the ground is zero.</p>
<p>The simplicity of the model, of course, comes at the expense of accuracy.</p>
<p>The model assumes that there is a single erosion-deposition threshold (<span class="math inline">\(n\)</span>); that advection does not vary with time; that the quantity of water does not have an impact; that raindrops do not have an impact; and that water only interacts with nitrogen. In the real world, we would likely see two thresholds for erosion-deposition <span class="citation" data-cites="Earle2015">(<a href="#ref-Earle2015" role="doc-biblioref">Earle 2015</a>)</span>. Raindrops, as seen in the equivalent exchange layer model, are big drivers of sediment transport. Also, in the real world, water carrying other things would impact its ability to pick up nitrogen.</p>
<section id="implementation-with-scikit-finitediff" class="level3">
<h3 class="anchored" data-anchor-id="implementation-with-scikit-finitediff">Implementation with Scikit FiniteDiff</h3>
<p>A finite difference scheme lets us see the behavior of the model easily. Using the Scikit Finite Difference package we can enter the equations symbolically, set boundary conditions, set initial conditions, and run simulations. This greatly simplifies the modeling workflow.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>bc <span class="op">=</span> {(<span class="st">"C"</span>, <span class="st">"x"</span>): (<span class="st">"dirichlet"</span>, <span class="st">"dirichlet"</span>),</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>      (<span class="st">"N"</span>, <span class="st">"x"</span>): (<span class="st">"dirichlet"</span>, <span class="st">"dirichlet"</span>)}</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Model([<span class="st">"-dx(C*v) + k*(dxxC) + N*e**(v-n)/(1+e**(v-n)) - C*e**(n-v)/(1+e**(n-v))"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"-N*e**(v-n)/(1+e**(v-n)) + C*e**(n-v)/(1+e**(n-v))"</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              [<span class="st">"C(x)"</span>, <span class="st">"N(x)"</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              parameters<span class="op">=</span>[<span class="st">"v(x)"</span>,<span class="st">"k"</span>,<span class="st">"n"</span>,<span class="st">"e"</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              boundary_conditions <span class="op">=</span> bc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" width="585" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-behavior" class="level2">
<h2 class="anchored" data-anchor-id="model-behavior">Model Behavior</h2>
<div class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.png" width="637" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The basic model behavior is working as intended. Nitrogen from the ground is picked up from areas where velocity is high and deposited in the area where velocity is low.</p>
<section id="modeling-with-different-advection" class="level3">
<h3 class="anchored" data-anchor-id="modeling-with-different-advection">Modeling with Different Advection</h3>
<p>To get a better grasp on the behavior of the model we run it with a variety of different initial conditions. Here we look at a less effective runoff prevention measure that does not slow down the water as much. In the original, the speed of advection is slowed to .5 at <span class="math inline">\(x = 8\)</span>, in this second run it only slows to a speed of 2. Looking at the y-axes of these plots compared to those above we can see that this has managed to catch much less of the nitrogen.</p>
<div class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" width="637" height="480" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These results are better visualized by looking at the total nitrogen present in the simulation over time. Nitrogen that is carried over the right boundary by the water is lost as runoff and we assume it enters the ecosystem. Good runoff mitigation will keep the total nitrogen present in the simulation high so it does not have a chance to enter the ecosystem and cause harmful algae blooms.</p>
<div class="cell" data-fig-height="8" data-fig-width="8" data-execution_count="9">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-10-output-1.png" width="585" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Different runoff prevention measures are represented by different advection slowdowns at <span class="math inline">\(x = 8\)</span>. The first graph represents no runoff prevention (a speed of 10 at <span class="math inline">\(x = 8\)</span>) and the last graph represents an advection speed of 1 at <span class="math inline">\(x = 8\)</span>. In each scenario, there is a period at the start where the nitrogen level declines very slowly. During this period most of the nitrogen simply has not had enough time to advect to the right boundary. This is followed by a period of rapid decline in nitrogen content that slowly tapers down until there is no nitrogen left. The lower graphs, which have the more significant runoff prevention measure, show a slower nitrogen loss.</p>
<p>The way the model is set up, as long as there is no area of zero velocity, the total nitrogen content will eventually reach zero. For example: if the erosion deposition threshold <span class="math inline">\(n\)</span> is 5 and the velocity over the entire area is 4 then, <span class="math display">\[
N_{t} = - N \frac{e^{-1}}{1 + e^{-1}} + C\frac{e^{1}}{1 + e^{1}}\\
\]</span></p>
<p>At a glance, this implies deposition but eventually, any positive <span class="math inline">\(C\)</span> is advected over the right boundary, and <span class="math inline">\(C = 0\)</span> so there can’t be deposition. Even though <span class="math inline">\(\frac{e^{-1}}{1 + e^{-1}}\)</span> is small it is the only term left so there will actually be erosion. If <span class="math inline">\(C = 0\)</span> and <span class="math inline">\(N &gt; 0\)</span> there will be erosion regardless of velocity. <span class="math inline">\(n\)</span> is not a hard cutoff where erosion becomes deposition, instead, it is the velocity where, assuming equal quantities of <span class="math inline">\(C\)</span> and <span class="math inline">\(N\)</span>, erosion and deposition are equal. As <span class="math inline">\(v\)</span> decreases, deposition just becomes a more dominant part of the model even though both deposition and erosion are still happening.</p>
<p>In the real world, it does not rain forever though, so slowing down the rate of nitrogen loss is still important.</p>
<p>I also looked at the effect of widening the low-velocity runoff mitigation area and found similar results.</p>
<div class="cell" data-fig-height="8" data-fig-width="8" data-execution_count="11">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-12-output-1.png" width="566" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anomalous-solute-transport" class="level3">
<h3 class="anchored" data-anchor-id="anomalous-solute-transport">Anomalous Solute Transport</h3>
<p>Modeling anomalous solute transport is important for understanding water pollution. In normal transport, solute moves consistently with some linear relationship to time. Anomalous transport typically involves the early or late arrival of a portion of the solute. It tends to occur in porous mediums and when there are multiple different paths for the solute to take. This is often modeled with fractional models as is discussed in <span class="citation" data-cites="sun2020">Sun et al. (<a href="#ref-sun2020" role="doc-biblioref">2020</a>)</span>. As seen earlier, the model developed here can replicate some of these characteristics. Most of the nitrogen reaches the right boundary of the simulation fairly early but small amounts of solute continue to arrive for a long time afterwards.</p>
<div class="cell" data-fig-width="8" data-execution_count="12">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-13-output-1.png" width="576" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-fig-width="8" data-execution_count="14">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-15-output-1.png" width="585" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can show the anomalous transport even better with a different initial condition. We set up alternating areas of fast and slow transport and a uniform initial distribution of nitrogen on the ground. This results in lots of nitrogen leaving the simulation at the start followed by smaller amounts of late-arriving nitrogen. When the simulation begins some of the nitrogen gets trapped in areas of low advection. Once trapped, it prevents other nitrogen from becoming trapped because a large enough <span class="math inline">\(N\)</span> can offset the deposition that occurs when advection speed is below <span class="math inline">\(n\)</span>. So, most of the nitrogen is carried to the end without getting trapped. Then, as the water becomes free of nitrogen there is no longer any deposition to offset, so the large <span class="math inline">\(N\)</span> just leads to erosion. The trapped nitrogen is slowly eroded and exits the simulation. This lines up very well with the theory of anomalous transport, which can often involve things like traps or side pools where the solute is stored temporarily.</p>
</section>
</section>
<section id="future-work" class="level2">
<h2 class="anchored" data-anchor-id="future-work">Future Work</h2>
<p>There is so much I would be interested in pursuing more if I had another two months to continue this project. I would first be interested in developing a more data driven approach to generating the spatially varying advection fields. This might require another mathematical model but it could also be done with an easier statistical approach using the data presented in <span class="citation" data-cites="liu2020">Liu et al. (<a href="#ref-liu2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>Another version of the model I used briefly had two different thresholds which more accurately matches how erosion and deposition work in the real world. The behavior of that model was extremely similar to the current model but I think it would be interesting to set up a couple of simulations to explore how they differ more methodically.</p>
<p>Implementing this model in 3D would be very straightforward using skfdiff and is also something I would want to look into. I think the main issue would be capturing how water moves around obstacles in the real world.</p>
<p>Moving away from just looking at nitrogen runoff I am interested in exploring what behavior results if velocity is made to depend on <span class="math inline">\(N\)</span>. <span class="math inline">\(N\)</span>, in that case, might represent something like soil that slows down water but can also be picked up and carried by it.</p>
</section>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Earle2015" class="csl-entry" role="listitem">
Earle, Steven. 2015. <em>Physical Geology</em>. BCcampus.
</div>
<div id="ref-liu2020" class="csl-entry" role="listitem">
Liu, H. Q., J. H. Yang, C. X. Liu, Y. F. Diao, D. P. Ma, F. H. Li, A. E. Rahma, and T. W. Lei. 2020. <span>“Flow Velocity on Cultivated Soil Slope with Wheat Straw Incorporation.”</span> <em>Journal of Hydrology</em> 584 (May): 124667. <a href="https://doi.org/10.1016/j.jhydrol.2020.124667">https://doi.org/10.1016/j.jhydrol.2020.124667</a>.
</div>
<div id="ref-michaelbeman2005" class="csl-entry" role="listitem">
Michael Beman, J., Kevin R. Arrigo, and Pamela A. Matson. 2005. <span>“Agricultural Runoff Fuels Large Phytoplankton Blooms in Vulnerable Areas of the Ocean.”</span> <em>Nature</em> 434 (7030): 211–14. <a href="https://doi.org/10.1038/nature03370">https://doi.org/10.1038/nature03370</a>.
</div>
<div id="ref-shao2023" class="csl-entry" role="listitem">
Shao, Fanfan, Wanghai Tao, Quanjiu Wang, Junhu Wu, Lijun Su, Haokui Yan, and Yibo Zhang. 2023. <span>“A Mathematical Model Using an Equivalent Exchange Layer for Predicting Raindrop-Induced Nutrient Ejection from Soil to Runoff on Bare and Vegetated Slopes.”</span> <em>Journal of Hydrology</em> 620 (May): 129546. <a href="https://doi.org/10.1016/j.jhydrol.2023.129546">https://doi.org/10.1016/j.jhydrol.2023.129546</a>.
</div>
<div id="ref-HAB2018" class="csl-entry" role="listitem">
Shumway, Sandra E., JoAnn M. Burkholder, and Steve L. Morton. 2018. <em>Harmful Algal Blooms: A Compendium Desk Reference</em>. Wiley Blackwell, John Wiley &amp;amp; Sons, Inc.
</div>
<div id="ref-sun2020" class="csl-entry" role="listitem">
Sun, Liwei, Han Qiu, Chuanhao Wu, Jie Niu, and Bill X. Hu. 2020. <span>“A Review of Applications of Fractional Advection-Dispersion Equations for Anomalous Solute Transport in Surface and Subsurface Water.”</span> <em>WIREs Water</em> 7 (4). <a href="https://doi.org/10.1002/wat2.1448">https://doi.org/10.1002/wat2.1448</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Nathaniel Reimer, 2023<br> All content licensed under <i class="bi-badge-cc"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">(CC BY-NC-SA 4.0)</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Site built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>