<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-04-17">
<meta name="description" content="An Exploration of a Double Robust Estimator for Causal Inference">

<title>Nathaniel Reimer - Doubly Robust Estimators</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nathaniel Reimer</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
  <ul>
  <li><a href="#doubly-robust-estimators" id="toc-doubly-robust-estimators" class="nav-link active" data-scroll-target="#doubly-robust-estimators">Doubly Robust Estimators</a></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a></li>
  <li><a href="#part-c-a-really-bad-estimator" id="toc-part-c-a-really-bad-estimator" class="nav-link" data-scroll-target="#part-c-a-really-bad-estimator">Part C: A Really Bad Estimator</a></li>
  <li><a href="#part-b-inverse-probability-weighting" id="toc-part-b-inverse-probability-weighting" class="nav-link" data-scroll-target="#part-b-inverse-probability-weighting">Part B: Inverse Probability Weighting</a></li>
  <li><a href="#part-a-outcome-regression" id="toc-part-a-outcome-regression" class="nav-link" data-scroll-target="#part-a-outcome-regression">Part A: Outcome Regression</a></li>
  <li><a href="#testing-doubly-robust-estimation" id="toc-testing-doubly-robust-estimation" class="nav-link" data-scroll-target="#testing-doubly-robust-estimation">Testing Doubly Robust Estimation</a></li>
  
  
  </ul>
</nav>
    </div>
<!-- main -->
<div class="quarto-about-marquee">
  <div class="about-image-container">
  </div>
  <div class="about-contents">
    <header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Doubly Robust Estimators</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Data Science</div>
    <div class="quarto-category">Statistics</div>
  </div>
  </div>
<div>
  <div class="description">
    An Exploration of a Double Robust Estimator for Causal Inference
  </div>
</div>
<div class="quarto-title-meta">
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 17, 2023</p>
    </div>
  </div>
  </div>
</header> <main class="content" id="quarto-document-content">

<section id="doubly-robust-estimators" class="level3">
<h3 data-anchor-id="doubly-robust-estimators">Doubly Robust Estimators</h3>
<p>Doubly Robust estimation allows researchers to take advantage of both an outcome model and a model of treatment. If one or both of the models is correct, the doubly robust estimator will produce an accurate estimate of the causal effect. Here I’ll focus on doubly robust estimation for a quantitative outcome and a binary treatment. Here is one such estimator:</p>
<span class="math display">\[\begin{aligned}
&amp;\frac{1}{n}\sum \left[ \hat{y}_1(\textrm{covariates}_i) + \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)} - \frac{\hat{y}_1(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)} \right] \\
-&amp;\frac{1}{n}\sum \left[ \hat{y}_0(\textrm{covariates}_i) + \frac{Y_i(1 - A_i) }{1 - \hat{e}(\textrm{covariates}_i)} - \frac{\hat{y}_0(\textrm{covariates}_i)*(1 - A_i)}{1 - \hat{e}(\textrm{covariates}_i)} \right] \\
&amp;\quad\quad\quad\quad\quad\quad (\textrm{A}) \quad\quad\quad\quad\quad\quad (\textrm{B}) \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad (\textrm{C})
\end{aligned}\]</span>
<p>Or, alternatively:</p>
<span class="math display">\[\begin{aligned}
(\textrm{A})  \hskip 2em &amp;\frac{1}{n}\sum \left[ \hat{y}_1(\textrm{covariates}_i) - \hat{y}_0(\textrm{covariates}_i) \right]\\
\\
(\textrm{B}) \hskip 1.2em +&amp;\frac{1}{n}\sum \left[ \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)} - \frac{Y_i(1 - A_i) }{1 - \hat{e}(\textrm{covariates}_i)} \right]\\
\\
(\textrm{C}) \hskip 1.2em -&amp;\frac{1}{n}\sum \left[\frac{\hat{y}_1(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)} -  \frac{\hat{y}_0(\textrm{covariates}_i)*(1 - A_i)}{1 - \hat{e}(\textrm{covariates}_i)} \right] \\
\\
\end{aligned}\]</span>
<p>Where</p>
<ul>
<li><p><span class="math inline">\(\hat{y}_1(\textrm{covariates}_i)\)</span> are the predicted values for each individual <span class="math inline">\(i\)</span> with treatment <span class="math inline">\(1\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{y}_0(\textrm{covariates}_i)\)</span> are the predicted values for each individual <span class="math inline">\(i\)</span> with treatment <span class="math inline">\(0\)</span>.</p></li>
<li><p><span class="math inline">\(Y_i\)</span> and <span class="math inline">\(A_i\)</span> are, respectively, the actual outcome and treatment values for each individual.</p></li>
<li><p><span class="math inline">\(\hat{e}(\textrm{covariates}_i)\)</span> are the predicted propensity scores for each individual <span class="math inline">\(i\)</span>.</p></li>
</ul>
<p>The rest of this page will attempt to explain how the doubly robust property works in this estimator.</p>
</section>
<section id="simulation" class="level3">
<h3 data-anchor-id="simulation">Simulation</h3>
<p>This is the causal diagram for our simulated data:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/daggity-1.png" class="img-fluid figure-img" alt="A causal graph with arrows from W, M, Z, and A to the outcome Y; an arrow from W to X; arrows from X, Z, and N to A" width="672"></p>
<figcaption class="figure-caption">Where Y is the outcome and A is a binary treatment. All relationships are linear.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="part-c-a-really-bad-estimator" class="level3">
<h3 data-anchor-id="part-c-a-really-bad-estimator">Part C: A Really Bad Estimator</h3>
<p>Each of the three parts of the doubly robust estimator is itself an estimator.</p>
<p><span class="math display">\[
(\textrm{C}) \quad\quad \frac{1}{n}\sum \frac{\hat{y}_1(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)} - \frac{1}{n}\sum \frac{\hat{y}_0(\textrm{covariates}_i)*(1- A_i)}{1-\hat{e}(\textrm{covariates}_i)}
\]</span> This produces an accurate estimate when both the treatment and outcome models are correct. So, it is essentially the opposite of a doubly robust estimator. If either model is wrong the estimate will be incorrect.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 10%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + W + M + Z</td>
<td style="text-align: left;">Y ~ A + W + M + Z</td>
<td style="text-align: left;">Y ~ A</td>
<td style="text-align: left;">Y ~ A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ N</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ N</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.99768</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.99768</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Part C</td>
<td style="text-align: left;">1.058516</td>
<td style="text-align: left;">3.998397</td>
<td style="text-align: left;">4.052766</td>
<td style="text-align: left;">3.982697</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="part-b-inverse-probability-weighting" class="level3">
<h3 data-anchor-id="part-b-inverse-probability-weighting">Part B: Inverse Probability Weighting</h3>
<p>An IPW estimator of the average causal effect is:</p>
<p><span class="math display">\[
(\textrm{B}) \quad\quad  \frac{1}{n}\sum \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)}  - \frac{1}{n}\sum \frac{Y_i (1-A_i)}{1-\hat{e}(\textrm{covariates}_i)}
\]</span></p>
<p>Where <span class="math inline">\(Y_i\)</span> are the actual outcome values. If the treatment model is correct this will produce a correct estimate of average causal effect.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 10%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + W + M + Z</td>
<td style="text-align: left;">Y ~ A + W + M + Z</td>
<td style="text-align: left;">Y ~ A</td>
<td style="text-align: left;">Y ~ A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ N</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ N</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.99768</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.99768</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Part B</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">3.997546</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">3.997546</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="parts-b-and-c-cancel-out-when-the-outcome-model-is-correct" class="level4">
<h4 data-anchor-id="parts-b-and-c-cancel-out-when-the-outcome-model-is-correct">Parts B and C cancel out when the outcome model is correct</h4>
<p>Focus just on the first terms of B and C. Note that these terms pertain to the treated individuals: <span class="math inline">\(A_i\)</span> is either 1 or 0 so <span class="math inline">\(Y_i A_i\)</span> gives us the <span class="math inline">\(Y_i\)</span> values of the treated individuals.</p>
<p><span class="math display">\[
\frac{1}{n}\sum \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)} - \frac{\hat{y}_1(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)}
\]</span></p>
<p><span class="math display">\[
(\textrm{B}_1) - (\textrm{C}_1)
\]</span></p>
<p>We see that if we have a correct outcome model then <span class="math inline">\(Y_i A_i = \hat{y}(\textrm{covariates}_i)* A_i\)</span> and so the whole thing would reduce zero.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>It does!</caption>
<colgroup>
<col style="width: 83%">
<col style="width: 16%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + Z + W + M</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ X</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">1.006395</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">4.36404</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\frac{1}{n}\sum \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)}\)</span></td>
<td style="text-align: left;">8.175909</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\frac{1}{n}\sum \frac{\hat{y}(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)}\)</span></td>
<td style="text-align: left;">8.177796</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Difference</td>
<td style="text-align: left;">-0.001887749</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If the outcome model were inaccurate then, <span class="math inline">\(Y_i A_i \neq \hat{y}(\textrm{covariates}_i)* A_i\)</span> and the whole thing does not reduce to zero. Instead of reducing to zero we might observe something like the first column:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 77%">
<col style="width: 11%">
<col style="width: 10%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + X</td>
<td style="text-align: left;">Y ~ A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">4.33691</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.982965</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\frac{1}{n}\sum \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)}\)</span></td>
<td style="text-align: left;">6.493073</td>
<td style="text-align: left;">7.987311</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\frac{1}{n}\sum \frac{\hat{y}(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)}\)</span></td>
<td style="text-align: left;">8.218912</td>
<td style="text-align: left;">7.987186</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Difference</td>
<td style="text-align: left;">-1.725839</td>
<td style="text-align: left;">0.0001254348</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note the second column, this is not actually a way to tell if the outcome model is correct.</p>
<p>Nevertheless, we now have two of the three parts of the doubly robust estimator.</p>
</section>
</section>
<section id="part-a-outcome-regression" class="level3">
<h3 data-anchor-id="part-a-outcome-regression">Part A: Outcome Regression</h3>
<p>We just saw how two parts of the doubly robust estimator add together to equal zero when the outcome model is correct. In the full doubly robust estimator we also add:</p>
<p><span class="math display">\[
(\textrm{A}) \quad\quad  \frac{1}{n}\sum \hat{y}_1(\textrm{covariates}_i) - \hat{y}_0(\textrm{covariates}_i)
\]</span></p>
<p>Since the other parts are zero when the outcome model is correct, the doubly robust estimator produces an estimate of average causal effect based on just the above sum.</p>
<p>This estimator alone produces a correct estimate of average causal effect when the outcome model is correct.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 17%">
<col style="width: 10%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + W + M + Z</td>
<td style="text-align: left;">Y ~ A + W + M + Z</td>
<td style="text-align: left;">Y ~ A</td>
<td style="text-align: left;">Y ~ A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ N</td>
<td style="text-align: left;">A ~ X + Z + N</td>
<td style="text-align: left;">A ~ N</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.99768</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">3.99768</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Part A</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="putting-everything-together" class="level4">
<h4 data-anchor-id="putting-everything-together">Putting everything together</h4>
<p>So the full estimator is:</p>
<span class="math display">\[\begin{aligned}
(\textrm{A})  \hskip 2em &amp;\frac{1}{n}\sum \left[ \hat{y}_1(\textrm{covariates}_i) - \hat{y}_0(\textrm{covariates}_i) \right]\\
&amp;\quad\quad \uparrow \textrm{Estimates correctly when the outcome model is correct} \\
\\
(\textrm{B}) \hskip 1.2em +&amp;\frac{1}{n}\sum \left[ \frac{Y_i A_i}{\hat{e}(\textrm{covariates}_i)} - \frac{Y_i(1 - A_i) }{1 - \hat{e}(\textrm{covariates}_i)} \right]\\
&amp;\quad\quad \uparrow \textrm{Estimates correctly when the treatment model is correct} \\
\\
(\textrm{C}) \hskip 1.2em -&amp;\frac{1}{n}\sum \left[\frac{\hat{y}_1(\textrm{covariates}_i)*A_i}{\hat{e}(\textrm{covariates}_i)} -  \frac{\hat{y}_0(\textrm{covariates}_i)*(1 - A_i)}{1 - \hat{e}(\textrm{covariates}_i)} \right] \\
&amp;\quad\quad \uparrow \textrm{Estimates correctly when both models are correct} \\
\\
\end{aligned}\]</span>
<p>Laid out like this, it is relatively simple to see how doubly robust estimation works. For example, if a researcher has an accurate exposure model and an inaccurate outcome model, <span class="math inline">\((\textrm{A})\)</span> and <span class="math inline">\((\textrm{C})\)</span> cancel each other out and we are left with just the accurate estimate based on the exposure model: <span class="math inline">\((\textrm{C})\)</span>. Take a little bit to think about the other possibilities yourself.</p>
</section>
</section>
<section id="testing-doubly-robust-estimation" class="level3">
<h3 data-anchor-id="testing-doubly-robust-estimation">Testing Doubly Robust Estimation</h3>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Accurate Models</th>
<th style="text-align: left;">Inaccurate Exposure Model</th>
<th style="text-align: left;">Inaccurate Exposure Model</th>
<th style="text-align: left;">Very Inaccurate Exposure Model</th>
<th style="text-align: left;">Inaccurate Models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + Z + W + M</td>
<td style="text-align: left;">Y ~ A + Z + W + M</td>
<td style="text-align: left;">Y ~ A + Z + W + M</td>
<td style="text-align: left;">Y ~ A + Z + W + M</td>
<td style="text-align: left;">Y ~ A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ Z + X + N</td>
<td style="text-align: left;">A ~ X + N</td>
<td style="text-align: left;">A ~ Z</td>
<td style="text-align: left;">A ~ N * N + N</td>
<td style="text-align: left;">A ~ X</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">4.384825</td>
<td style="text-align: left;">1.219445</td>
<td style="text-align: left;">3.99768</td>
<td style="text-align: left;">4.36404</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">4.395095</td>
<td style="text-align: left;">1.225058</td>
<td style="text-align: left;">3.997546</td>
<td style="text-align: left;">4.371975</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: left;">-1.058516</td>
<td style="text-align: left;">-4.397362</td>
<td style="text-align: left;">-1.226231</td>
<td style="text-align: left;">-3.998397</td>
<td style="text-align: left;">-3.991018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubly Robust Estimate</td>
<td style="text-align: left;">1.002187</td>
<td style="text-align: left;">1.004128</td>
<td style="text-align: left;">1.005223</td>
<td style="text-align: left;">1.005544</td>
<td style="text-align: left;">4.363788</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The real causal effect in our simulated data is 1. With inaccurate exposure models and an accurate outcome model we observe, just as we would expect, <span class="math inline">\((\textrm{B})\)</span> and <span class="math inline">\((\textrm{C})\)</span> cancel out and we are left with an estimate based on <span class="math inline">\((\textrm{A})\)</span>. When both models are inaccurate this does not happen.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 19%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Accurate Models</th>
<th style="text-align: left;">Inaccurate Outcome Model</th>
<th style="text-align: left;">Inaccurate Outcome Model</th>
<th style="text-align: left;">Very Inaccurate Outcome Model</th>
<th style="text-align: left;">Inaccurate Models</th>
<th style="text-align: left;">Inaccurate Models</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Outcome Formula</td>
<td style="text-align: left;">Y ~ A + Z + W + M</td>
<td style="text-align: left;">Y ~ A + N</td>
<td style="text-align: left;">Y ~ A * Z + W</td>
<td style="text-align: left;">Y ~ A</td>
<td style="text-align: left;">Y ~ A</td>
<td style="text-align: left;">Y ~ A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exposure Formula</td>
<td style="text-align: left;">A ~ Z + X + N</td>
<td style="text-align: left;">A ~ Z + X + N</td>
<td style="text-align: left;">A ~ Z + X + N</td>
<td style="text-align: left;">A ~ Z + X + N</td>
<td style="text-align: left;">A ~ X</td>
<td style="text-align: left;">A ~ M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Outcome Model Estimate</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.997467</td>
<td style="text-align: left;">1.005835</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW Estimate</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">0.9860699</td>
<td style="text-align: left;">4.36404</td>
<td style="text-align: left;">3.982965</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: left;">1.006395</td>
<td style="text-align: left;">3.997467</td>
<td style="text-align: left;">1.006498</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
<td style="text-align: left;">3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">1.054308</td>
<td style="text-align: left;">4.371975</td>
<td style="text-align: left;">3.982964</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: left;">-1.058516</td>
<td style="text-align: left;">-4.067476</td>
<td style="text-align: left;">-1.059288</td>
<td style="text-align: left;">-4.052766</td>
<td style="text-align: left;">-3.991018</td>
<td style="text-align: left;">-3.982831</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doubly Robust Estimate</td>
<td style="text-align: left;">1.002187</td>
<td style="text-align: left;">0.9842992</td>
<td style="text-align: left;">1.001518</td>
<td style="text-align: left;">0.9843736</td>
<td style="text-align: left;">4.363788</td>
<td style="text-align: left;">3.982965</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When we have an accurate exposure and an inaccurate outcome model, <span class="math inline">\((\textrm{A})\)</span> and <span class="math inline">\((\textrm{C})\)</span> cancel out and we are left with an estimate based on <span class="math inline">\((\textrm{B})\)</span>.</p>
</section>


<div id="quarto-appendix" class="default"><section id="sources" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Sources</h2><div class="quarto-appendix-contents">

<p>“Doubly Robust Estimation of Causal Effects” by Funk et al.&nbsp;and “A Falsifiability Characterization of Double Robustness Through Logical Operators” by Frangakis were used heavily in this project. My goal in this project was essentially to create an explanation of double robustness that combined Frangakis’ logical framework with the more numerical and simulation-based approach of the Funk paper.</p>
<p><a href="https://doi.org/10.1093/aje/kwq439">Doubly Robust Estimation of Causal Effects</a></p>
<p><a href="https://www.degruyter.com/document/doi/10.1515/jci-2018-0016/html?lang=en">A Falsifiability Characterization of Double Robustness Through Logical Operators</a></p>
</div></section><section id="code" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Code</h2><div class="quarto-appendix-contents">

<section id="simulating-data" class="level3">
<h3 data-anchor-id="simulating-data">Simulating Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">1</span>, <span class="dv">2</span>) <span class="co"># Z</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, .<span class="dv">5</span>) <span class="co"># W</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">2</span><span class="sc">*</span>W, <span class="dv">2</span>) <span class="co"># X</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">20</span>, <span class="dv">1</span>) <span class="co"># M</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">2</span>) <span class="co"># N</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>log_odds_A <span class="ot">&lt;-</span> .<span class="dv">25</span> <span class="sc">*</span> Z <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> X <span class="sc">+</span> .<span class="dv">1</span> <span class="sc">*</span> N</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>odds_A <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_odds_A)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>p_A <span class="ot">&lt;-</span> odds_A <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> odds_A)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_A) <span class="co"># A</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, A <span class="sc">+</span> W <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> Z <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> M <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">2</span>, <span class="dv">1</span>), .<span class="dv">25</span>) <span class="co"># Y</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> (A), <span class="at">Y =</span> Y, <span class="at">Z =</span> Z, <span class="at">M =</span> M, <span class="at">W =</span> (W), <span class="at">X =</span> X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-for-normal-methods" class="level3">
<h3 data-anchor-id="function-for-normal-methods">Function for Normal Methods</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>get_normal_methods <span class="ot">&lt;-</span> <span class="cf">function</span>(data, outcome_formula, exposure_formula) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  outcome <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome_formula)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  ps_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(exposure_formula, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ps =</span> <span class="fu">predict</span>(ps_model, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ipw =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            A <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>ps,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            A <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>ps)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  example_ipw <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> data, <span class="at">weights =</span> ipw)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(summary(example_ipw)$coefficients)</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(summary(outcome)$coefficients)</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  mods <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">c</span>(outcome_formula,exposure_formula))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(mods, outcome<span class="sc">$</span>coefficients[<span class="dv">2</span>], example_ipw<span class="sc">$</span>coefficients[<span class="dv">2</span>]))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome Formula"</span>,<span class="st">"Exposure Formula"</span>,<span class="st">"Causal Effect Estimate from Outcome Model"</span>, <span class="st">"Causal Effect Estimate from Treatment Model"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-for-two-parts-of-dr-estimator" class="level3">
<h3 data-anchor-id="function-for-two-parts-of-dr-estimator">Function for Two Parts of DR Estimator</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>get_dr_parts2_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, outcome_formula, exposure_formula) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  outcome <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome_formula)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  ps_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(exposure_formula, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  forceA0 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">A =</span> <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  forceA1 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">A =</span> <span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  predA0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(outcome, <span class="at">newdata =</span> forceA0)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  predA1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(outcome, <span class="at">newdata =</span> forceA1)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ps =</span> <span class="fu">predict</span>(ps_model, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ipw =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            A <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>ps,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            A <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>ps)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> predA1</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> ((data<span class="sc">$</span>Y <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> (data<span class="sc">$</span>ps))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  part3 <span class="ot">&lt;-</span> <span class="sc">-</span>((predA1 <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> data<span class="sc">$</span>ps)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  example_ipw <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> data, <span class="at">weights =</span> ipw)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  mods <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">c</span>(outcome_formula,exposure_formula))</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(mods, outcome<span class="sc">$</span>coefficients[<span class="dv">2</span>], example_ipw<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="fu">mean</span>(part2), <span class="fu">mean</span>(<span class="sc">-</span>part3), <span class="fu">mean</span>(part2<span class="sc">+</span>part3)))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome Formula"</span>,<span class="st">"Exposure Formula"</span>, <span class="st">"Outcome Model Estimate"</span>, <span class="st">"IPW Estimate"</span>, <span class="st">"$B$"</span>, <span class="st">"$C$"</span>, <span class="st">"D"</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-for-all-parts-of-dr-estimator" class="level3">
<h3 data-anchor-id="function-for-all-parts-of-dr-estimator">Function for All Parts of DR Estimator</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>get_dr_parts <span class="ot">&lt;-</span> <span class="cf">function</span>(data, outcome_formula, exposure_formula) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  outcome <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome_formula)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  ps_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(exposure_formula, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ps =</span> <span class="fu">predict</span>(ps_model, <span class="at">newdata =</span> data, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ipw =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            A <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>ps,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>            A <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>ps)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  example_ipw <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> data, <span class="at">weights =</span> ipw)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  forceA0 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">A =</span> <span class="dv">0</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  forceA1 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">A =</span> <span class="dv">1</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  predA0 <span class="ot">&lt;-</span> <span class="fu">predict</span>(outcome, <span class="at">newdata =</span> forceA0)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  predA1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(outcome, <span class="at">newdata =</span> forceA1)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  DR1 <span class="ot">&lt;-</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    (((    data<span class="sc">$</span>A) <span class="sc">*</span> data<span class="sc">$</span>Y) <span class="sc">/</span> (    data<span class="sc">$</span>ps)) <span class="sc">-</span>      <span class="co"># IPW part</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    ((predA1 <span class="sc">*</span> (data<span class="sc">$</span>A <span class="sc">-</span> data<span class="sc">$</span>ps))) <span class="sc">/</span> (    data<span class="sc">$</span>ps)  <span class="co"># Other thing</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  DR0 <span class="ot">&lt;-</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    (((<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A) <span class="sc">*</span> data<span class="sc">$</span>Y) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps)) <span class="sc">+</span>      <span class="co"># IPW part</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    ((predA0 <span class="sc">*</span> (data<span class="sc">$</span>A <span class="sc">-</span> data<span class="sc">$</span>ps))) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps)  <span class="co"># Other thing</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  Estimator1 <span class="ot">&lt;-</span> predA1 <span class="sc">+</span> ((data<span class="sc">$</span>Y <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> (data<span class="sc">$</span>ps)) <span class="sc">-</span> ((predA1 <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> data<span class="sc">$</span>ps)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  Estimator0 <span class="ot">&lt;-</span> predA0 <span class="sc">+</span> ((data<span class="sc">$</span>Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps)) <span class="sc">-</span> ((predA0 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps))</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> predA1</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> ((data<span class="sc">$</span>Y <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> (data<span class="sc">$</span>ps))</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  part3 <span class="ot">&lt;-</span> <span class="sc">-</span>((predA1 <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> data<span class="sc">$</span>ps)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  part1A0 <span class="ot">&lt;-</span> predA0</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  part2A0 <span class="ot">&lt;-</span> ((data<span class="sc">$</span>Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps))</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  part3A0 <span class="ot">&lt;-</span> <span class="sc">-</span>((predA0 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps))</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  partdr1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(part1) <span class="sc">-</span> <span class="fu">mean</span>(part1A0)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  partdr2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((data<span class="sc">$</span>Y <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> (data<span class="sc">$</span>ps)) <span class="sc">-</span> <span class="fu">mean</span>((data<span class="sc">$</span>Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps))</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  partdr3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">-</span>((predA1 <span class="sc">*</span> data<span class="sc">$</span>A) <span class="sc">/</span> data<span class="sc">$</span>ps)) <span class="sc">-</span> <span class="fu">mean</span>(<span class="sc">-</span>((predA0 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>A)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> data<span class="sc">$</span>ps)))</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  mods <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">c</span>(outcome_formula,exposure_formula))</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(mods, outcome<span class="sc">$</span>coefficients[<span class="dv">2</span>], example_ipw<span class="sc">$</span>coefficients[<span class="dv">2</span>], partdr1, partdr2, partdr3, <span class="fu">sum</span>(partdr1, partdr2, partdr3)))</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Outcome Formula"</span>,<span class="st">"Exposure Formula"</span>, <span class="st">"Outcome Model Estimate"</span>, <span class="st">"IPW Estimate"</span>, <span class="st">"$B$"</span>, <span class="st">"$C$"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</div></section></div></main> 
  </div>
</div>
 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Nathaniel Reimer, 2023<br> All content licensed under <i class="bi-badge-cc"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">(CC BY-NC-SA 4.0)</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Site built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>