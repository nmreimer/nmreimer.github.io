{
  "hash": "9d2663ac44acf4a55872fccbf793b805",
  "result": {
    "markdown": "---\ntitle: Modeling Advection Diffusion with Erosion and Depositon\nauthor: Nathaniel Reimer\ndate: '2023-12-15'\nformat: html\neditor: visual\nexecute:\n  freeze: auto\n  echo: false\n  warning: false\n  message: false\nbibliography: references.bib\n---\n\n## Introduction\n\nPollutant runoff is harmful to many ecosystems. Agricultural runoff can be particularly harmful to ecosystems because it contains a high concentration of nitrogen. This nitrogen is primarily from nitrogen fertilizers vital to global food supplies. When nitrogen is allowed to enter oceans and waterways it can fuel phytoplankton blooms [@michaelbeman2005]. Phytoplankton blooms, particularly those involving toxix species, can devastate ecosystems and the people that live near and rely on those ecosystems [@HAB2018]. There are a variety of mitigation methods for reducing the amount of nitrogen that is carried out of agricultural areas by runoff.\n\n## A Potential Model\n\nWe represent nitrogen dissolved in water with $C$ and nitrogen deposited on the ground with $N$. Nitrogen in water is subject to simple advection-diffusion: $C_{t} = -(Cv)_{x} + kC_{xx}$. Nitrogen on the ground is stationary. Some hydrological models of pollutant transport use similar logical frameworks. Shao et al. use an equivalent exchange layer to mediate between surface runoff and nutrients stored in the ground [@shao2023]. A fractional mobile-immobile model is similarly predicated on simple advection diffusion with mobile and immobile components of the solute [@sun2020]. Both models present complicated methods for transfer between the two states.\n\n\n\n$$\nC_{t} = -(Cv)_{x} + kC_{xx} + N \\frac{e^{v-n}}{1 + e^{v-n}} - C\\frac{e^{n-v}}{1 + e^{n-v}}\\\\  \n$$\n\n$$\nN_{t} = - N \\frac{e^{v-n}}{1 + e^{v-n}} + C\\frac{e^{n-v}}{1 + e^{n-v}}\\\\\n$$\n\nWe represent transfers between ground nitrogen and dissolved nitrogen in this model with $N \\frac{e^{v-n}}{1 + e^{v-n}} - C\\frac{e^{n-v}}{1 + e^{n-v}}$. For fixed levels of $N$ and $C$, a velocity $v > n$ will lead to erosion. For $v >> n$, the rate of erosion approaches $N$. On the other hand, if velocity $v < n$ deposition will occur. For $v << n$, the rate of deposition approaches $C$. This ensures that no deposition will occur if the dissolved concentration is zero and no erosion will occur if the concentration on the ground is zero.\n\nThe simplicity of the model, of course, comes at the expense of accuracy.\n\nThe model assumes that there is a single erosion-deposition threshold ($n$); that advection does not vary with time; that the quantity of water does not have an impact; that raindrops do not have an impact; and that water only interacts with nitrogen. In the real world we would likely see two thresholds for erosion-deposition [@Earle2015]. Raindrops, as seen in the equivalent exchange layer model, are big drivers of sediment transport. Also, in the real world, water carrying other things would impact it's ability to pick up nitrogen.\n\n### Implementation with Scikit FiniteDiff\n\nA finite difference scheme lets us see the behavior of the model easily. Using the Scikit Finite Difference package we can enter the equations symbolically, set boundary conditions, set initial conditions, and run simulations. This greatly simplifies the modeling workflow.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nbc = {(\"C\", \"x\"): (\"dirichlet\", \"dirichlet\"),\n      (\"N\", \"x\"): (\"dirichlet\", \"dirichlet\")}\n\nmodel = Model([\"-dx(C*v) + k*(dxxC) + N*e**(v-n)/(1+e**(v-n)) - C*e**(n-v)/(1+e**(n-v))\",\n               \"-N*e**(v-n)/(1+e**(v-n)) + C*e**(n-v)/(1+e**(n-v))\"],\n              [\"C(x)\", \"N(x)\"],\n              parameters=[\"v(x)\",\"k\",\"n\",\"e\"],\n              boundary_conditions = bc)\n```\n:::\n\n\n::: {.cell execution_count=3}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-1.png){width=585 height=449 fig-align='center'}\n:::\n:::\n\n\n## Model Behavior\n\n\n\n::: {.cell execution_count=5}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=637 height=480 fig-align='center'}\n:::\n:::\n\n\nThe basic model behavior is working as intended. Nitrogen from the ground is picked up from areas where velocity is high and deposited in the area where velocity is low.\n\n### Modeling with Different Advection\n\nTo get a better grasp on the behavior of the model we run it with a variety of different initial conditions. Here we look at a less effective runoff prevention measure that does not slow down the water as much. In the original the speed of advection is slowed to .5 at $x = 8$, in this second run it only slows to a speed of 2. Looking at the y-axes of these plots compared to those above we can see that this has managed to catch much less of the nitrogen.\n\n\n\n::: {.cell execution_count=7}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-8-output-1.png){width=637 height=480 fig-align='center'}\n:::\n:::\n\n\nThese results are better visualized by looking at the total nitrogen present in the simulation over time. Nitrogen that is carried over the right boundary by the water is lost as runoff and we assume it enters the ecosystem. A good runoff mitigation will keep the total nitrogen present in the simulation high so it does not have a chance to enter the ecosystem and cause harmful algae blooms.\n\n\n\n::: {.cell fig-height='8' fig-width='8' execution_count=9}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-10-output-1.png){width=585 height=449 fig-align='center'}\n:::\n:::\n\n\nDifferent runoff prevention measures are represented by different advection slow downs at $x = 8$. The first graph represents no runoff prevention (a speed of 10 at $x = 8$) and the last graph represents an advection speed of 1 at $x = 8$. In each scenario, there is a period at the start where the nitrogen level declines very slowly. During this period most of the nitrogen simply has not had enough time to advect to the right boundary. This is followed by a period of rapid decline in nitrogen content that slowly tapers down until there is no nitrogen left. The lower graphs, which have the more significant runoff prevention measure, show a slower nitrogen loss.\n\nThe way the model is set up, as long as there is no area of zero velocity, the total nitrogen content will eventually reach zero. For example: if the erosion deposition threshold $n$ is 5 and the velocity over the entire area is 4 then, $$\nN_{t} = - N \\frac{e^{-1}}{1 + e^{-1}} + C\\frac{e^{1}}{1 + e^{1}}\\\\\n$$\n\nAt a glance this implies deposition but eventually any positive $C$ is advected over the right boundary and $C = 0$ so there can't be deposition. Even though $\\frac{e^{-1}}{1 + e^{-1}}$ is small it is the only term left so there will actually be erosion. If $C = 0$ and $N > 0$ there will be erosion regardless of velocity. $n$ is not a hard cutoff where erosion becomes deposition, instead it is the velocity where, assuming equal quantities of $C$ and $N$, erosion and deposition are equal. As $v$ decreases, deposition just becomes a more dominant part of the model even though both deposition and erosion are still happening.\n\nIn the real world it does not rain forever though, so slowing down the rate of nitrogen loss is still important.\n\nI also looked at the effect of widening the low velocity runoff mitigation area and found similar results.\n\n\n\n::: {.cell fig-height='8' fig-width='8' execution_count=11}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-1.png){width=566 height=449 fig-align='center'}\n:::\n:::\n\n\n### Anomalous Solute Transport\n\nModeling anomalous solute transport is important for understanding water pollution. In normal transport, solute moves consistantly with some linear relationship to time. Anomalous transport typically involves the early or late arrival of a portion of the solute. It tends to occur in porous mediums and when there are multiple different paths for the solute to take. This is often modeled with fractional models as is discussed in @sun2020. As seen earlier, the model developed here can replicate some of these characteristics. Most of the nitrogen reaches the right boundary of the simulation fairly early but small amounts of solute continue to arrive for a long time afterwards.\n\n::: {.cell fig-width='8' execution_count=12}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-13-output-1.png){width=576 height=449 fig-align='center'}\n:::\n:::\n\n\n\n\n::: {.cell fig-width='8' execution_count=14}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-15-output-1.png){width=585 height=429 fig-align='center'}\n:::\n:::\n\n\nWe can show the anomalous transport even better with a different initial condition. We set up alternating areas of fast and slow transport and a uniform initial distribution of nitrogen on the ground. This results in lots of nitrogen leaving the simulation at the start followed by smaller amounts of late arriving nitrogen. When the simulation begins some of the nitrogen gets trapped in areas of low advection. Once trapped, it prevents other nitrogen from becoming trapped because a large enough $N$ can offset the deposition that occurs when advection speed is below $n$. So, most of the nitrogen is carried to then end without getting trapped. Then, as the water becomes free of nitrogen there is no longer any deposition to offset, so the large $N$ just leads to erosion. The trapped nitrogen is slowly eroded and exits the simulation. This lines up very well with the theory of anomalous transport, which can often involve things like traps or side pools where solute is stored temporarily.\n\n## Future Work\n\nThere is so much I would be interested in pursing more if I had another two months to continue this project. I would first be interested in developing a more data driven approach to generating the spacially varying advection fields. This might require another mathematical model but it could also be done with an easier statistical approach using the data presented in @liu2020.\n\nAnother version of the model I used briefly had two different thresholds which more accurately matches how erosion and deposition work in the real world. The behavior of that model was extreemly similar to the current model but I think it would be interesting to set up a couple of simulations to explore how they differ more methodically.\n\nImplementing this model in 3D would be very straight forward using skfdiff and is also something I would want to look into. I think the main issue would be capturing how water moves around obstacles in the real world.\n\nMoving away from just looking at nitrogen runoff I am interested in exploring what behavior results if velocity is made to depend on $N$. $N$, in that case, might represent something like soil that slows down water but can also be picked up and carried by it.\n\n## Slides\n\n[Presentation Slides](https://nmreimer.github.io/presentation.html)\n\n## References\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}